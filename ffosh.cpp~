
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <unistd.h>

#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <iostream>
#include <map>
#include <sstream>
#include <string>

#include "handleInput.h"

extern char ** environ;

int main(void) {
  setenv("ECE551PATH", getenv("PATH"), 1);
  // std::vector<char *> path;
  //int count = 0;
  while (true) {
    // ++count;
    //path.push_back(getenv("PATH"));
    //if (count != 1) {
    // if (path[path.size() - 1] != path[path.size() - 2]) {
    //  setenv("ECE551PATH", getenv("PATH"), 1);
    // }
    // }
    std::string command;
    shell ffosh;
    ffosh.showPrompt();
    std::getline(std::cin, command);
    std::string ext = "exit";
    if (std::cin.eof() || (strcmp(ext.c_str(), command.c_str()) == 0)) {
      return EXIT_SUCCESS;
    }
    if (command.empty()) {
      continue;
    }
    Input in;
    if (!in.parsecmd(command, ffosh)) {
      continue;
    }
    in.handleBackSlash(ffosh);
    ffosh.replaceVar();
    BuiltIn bt;
    if (bt.handleBuiltIn(ffosh)) {
      continue;
    }
    ffosh.execute();
  }
  return EXIT_SUCCESS;
}
